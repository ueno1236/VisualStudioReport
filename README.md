# Debug of VisualStudio

## Breakpoint

動作が怪しい箇所をブレークポイントで挟んで前後の変数の変化を見る

BreakPointの使用方法  
ソース コードにブレークポイントを設定
デバッグ->ブレークポイントの設定/解除」から操作出るが「F9」キーでやった方が早い

[![Image from Gyazo](https://i.gyazo.com/f44bbd93f74e890e54d94f180e0d6a35.png)](https://gyazo.com/f44bbd93f74e890e54d94f180e0d6a35)

デバッグすると、その行のコードが実行される前に、ブレークポイントで「実行が一時停止します。 ブレークポイント シンボルでは、黄色の矢印ボタンを示しています。

[![Image from Gyazo](https://i.gyazo.com/0f1cb1bcc9141ad5cc2ee9d865806cb4.png)](https://gyazo.com/0f1cb1bcc9141ad5cc2ee9d865806cb4)

ブレークポイントでデバッガーが停止したら、変数の値などのアプリの現在の状態を確認できます。

>ブレークポイントは、実行可能ファイルの任意のコード行に設定できます。  
などの次の c# コード、する可能性がありますにブレークポイントを設定変数の宣言、foループ、または任意のコード内で、forループします。  
名前空間またはクラス宣言、またはメソッド シグネチャでは、ブレークポイントを設定できません。

---

## Step in

step inは　1行進み関数の中に入り変数の値を確認することができる。  
［デバッグ］メニューの［ステップイン］(F11)

[![Image from Gyazo](https://i.gyazo.com/7cc3837996a21016b36da9de1d9f1148.png)](https://gyazo.com/7cc3837996a21016b36da9de1d9f1148)

## Step out

もし間違って、動作を見なくて良いと思う関数(メソッドやプロパティ)の中に入ってしまった場合には、［デバッグ］メニューの［ステップアウト］(Shift＋F11)を利用できる。

[![Image from Gyazo](https://i.gyazo.com/7815e94dc1d7ef64936c8d660a5b8d31.gif)](https://gyazo.com/7815e94dc1d7ef64936c8d660a5b8d31)

## Step over

関数またはメソッド呼び出しのコード行にあるとき、F11 の代わりに F10 を押すことができます  
［デバッグ］メニューの［ステップオーバー］(F10)  
F10 キーを押すと、アプリ コード内の関数またはメソッドにステップ インすることなく、デバッガーが進められる (コードはまだ実行されてる)。  

[![Image from Gyazo](https://i.gyazo.com/7811157a8b2f677adfc4f63bbb52cd0f.gif)](https://gyazo.com/7811157a8b2f677adfc4f63bbb52cd0f)

F10 キーを押すことで、関心のないコードをスキップできます。 この方法により、関心の高いコードまですばやく到達できる。

>Visual Studio のようなデバッグ ツールでコードを 1 ステップずつ実行し、プログラミングが間違っている箇所を正確に発見することができるため効果的。  
次に、行う必要があるコード修正を理解しますが、多くの場合、デバッグ ツールでは、プログラムの実行を続けながら、一時的に変更して見ることができる。

---

## 自動変数・ローカル変数ウィンドウ  

変数の現在の値を確認できるウィンドウ

実行中断中に、デバッグメニューのウィンドウメニューの中の中段あたりに「ウォッチ」「自動変数」「ローカル」というメニューが並んでいる。  
これらを選択すると、変数の中身を確認するためのウィンドウが開く

ローカルウィンドウ  
全ての変数が表示されています。まだ使用されていない変数も表示されます。  
[![Image from Gyazo](https://i.gyazo.com/6da32fee013e037df0cf4060d273fb6e.png)](https://gyazo.com/6da32fee013e037df0cf4060d273fb6e)

次に自動変数ウィンドウ  
ブレークポイントを設定した行の変数と、その前の行で使用されている変数が表示されています。  
[![Image from Gyazo](https://i.gyazo.com/86ae6df5728a56a2323aad548801b69c.png)](https://gyazo.com/86ae6df5728a56a2323aad548801b69c)

---

## ウォッチ式  

プログラムをデバッグ実行すると、ブレークポイントまで実行が進んだ時点で、実行が中断され、IDE(統合開発環境)下部に［ローカル］ウィンドウ、［ウォッチ 1］ウィンドウなどが表示される。  
[![Image from Gyazo](https://i.gyazo.com/f5d2a8d2d77a49ddd1fd53ed20751992.png)](https://gyazo.com/f5d2a8d2d77a49ddd1fd53ed20751992)

［ウォッチ］ウィンドウにウォッチ式を追加する簡単な方法は、デバッグ実行が中断した状態で、ウォッチしたい対象を右クリックして、コンテキストメニューから［ウォッチの追加］を選択する
[![Image from Gyazo](https://i.gyazo.com/9513b24c8dab59d809ac3dd3d294afe4.png)](https://gyazo.com/9513b24c8dab59d809ac3dd3d294afe4)

>［ウォッチ］ウィンドウを使うと、プログラムのデバッグ実行時にさまざまな情報を、プログラマーが望む形で表示できるようになる。式の追加はとても簡単に行え、その編集もすぐにできる。また、大規模なプログラムでは、最大4つまでの［ウォッチ］ウィンドウに関連のある情報だけをまとめて表示することも可能だ。使いこなせば、デバッグをより効率的に行えるようになるだろう。

---

## データブレイクポイント

特定の変数が値変化した瞬間に、該当するソースコードの部分でプログラムを停止させることができる

1. 任意の場所でブレークポイントを置いてプログラムを中断させる

1. メニューバーの[デバッグ] -> [ブレークポイントの作成] -> [データブレイクポイント]をクリックする

1. データブレークポイントを設定するアドレスを入力する

[![Image from Gyazo](https://i.gyazo.com/00e20c5a02376d7e50e4563c7396804e.png)](https://gyazo.com/00e20c5a02376d7e50e4563c7396804e)

データブレークに引っかかると下記のようなダイアログが表示される。

[![Image from Gyazo](https://i.gyazo.com/b61330da743729f0a88f2789f2e62d01.png)](https://gyazo.com/b61330da743729f0a88f2789f2e62d01)

>プログラミングをしていると、想定外の不具合が発生することはよくある。  
変わるはずのない変数の値が変わっていたり、突然プログラムが強制終了したりと様々。  
そんな時に予想される不具合がメモリ破壊。  
メモリ破壊は破壊直後に落ちずに、破壊したメモリが参照されるときに初めて不具合が分かる事が多いので、不具合の原因を調査するのが困難。  
その場合に有効になるのがデータブレイクポイントである。

---

## メモリウィンドウ

メモリウィンドウは、デバッグ セッション中にのみ使用できる

メモリウィンドウを開くには

1. ツール > オプション(またはデバッグ > オプション) >デバッグ > 全般

1. 緑色の矢印を選択してデバッグを開始キーを押してF5、または選択デバッグ > デバッグの開始

1. デバッグ > Windows > メモリ  
(一部のエディションのVisual Studio1 つだけ提供メモリウィンドウ)

[![Image from Gyazo](https://i.gyazo.com/90df7e5b6432ae8b33f8980d6fa9c0c7.png)](https://gyazo.com/90df7e5b6432ae8b33f8980d6fa9c0c7)

* メモリ内でポインターを追跡するには

  1. アドレスとして評価されるポインター式を入力  
[![Image from Gyazo](https://i.gyazo.com/7aa43a2ebfd6114c6ec4f6654b92cf03.png)](https://gyazo.com/7aa43a2ebfd6114c6ec4f6654b92cf03)

  1. ダブルクリックでポインタ変数を選択して、メモリウィンドウにドラッグ&ドロップする
[![Image from Gyazo](https://i.gyazo.com/b05379e3a75acace89d3a8bd819e0eda.gif)](https://gyazo.com/b05379e3a75acace89d3a8bd819e0eda)

>メモリの内容を監視する。  
プログラムの実行中に変わるすべての値が16進で表示される

---

## コールスタック(呼び出し履歴)

この機能は、ブレークポイントと組み合わせて使用する。  
ブレークポイントによって実行を一時停止させ、その時点までにどのような経路をたどって、現在の関数に到達したのかを確認できる。

コールスタックを開くには  
メニューバーから【デバッグ】＞【ウィンドウ】＞【呼び出し履歴】を選択する  
ショートカットキーは Alt + 7
[![Image from Gyazo](https://i.gyazo.com/cd57ab56b0e47bacebb80031c8c6014f.png)](https://gyazo.com/cd57ab56b0e47bacebb80031c8c6014f)

左端の黄色い矢印が、現在の実行位置を示している。なので下の行に行くほど、早い段階で呼び出された関数となる。

自分で書いたプログラムでない部分は、「外部コード」と表示される。

> 【呼び出し履歴】ウィンドウで、行の上でダブルクリックすると、デバッグのコンテキスト（文脈）を切り替えられる。  
つまり、その関数が実行されようとしていた時点での状況に、各種デバッグ表示を切り替えられる  
**このとき、【呼び出し履歴】ウィンドウの方は、左端に緑色の矢印が表示される。**  
デバッグのコンテキストを切り替えることによって、別の関数ではどんな状況であったかを調べることができる

---

## イミディエイトウィンドウ

イミディエイトウィンドウを開くには  
[デバッグ] メニューの [ウィンドウ] > [イミディエイト]

この機能は、ブレークポイントと組み合わせて使用する  
break point で止まっているときにイミディエイトウィンドウにコードを打つと評価して結果を確認できる

[![Image from Gyazo](https://i.gyazo.com/eaee8b2d4470d3e492185cab51490027.png)](https://gyazo.com/eaee8b2d4470d3e492185cab51490027)

**値を受け取って表示するだけでなく 値の変更もできます
代入式を評価すれば代入もできます**

[![Image from Gyazo](https://i.gyazo.com/9e042a1684b74ef5f00534c5c748bd9f.png)](https://gyazo.com/9e042a1684b74ef5f00534c5c748bd9f)

>イミディエイトという言葉は「即時の」という意味を持っている。  
イミディエイトウィンドウは、知りたいこと・確認したいことを即時に知ることができるウィンドウ。

---

## Debug tool を使用すると、例外が発生したコード内の場所を正確に特定でき、考えられる修正方法を調査するのに役立ちます

---
